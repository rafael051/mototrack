<!-- File: templates/index.html -->
<!DOCTYPE html>
<html lang="pt-br"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <th:block th:replace="~{fragments/head :: head('MotoTrack • Início')}"></th:block>
    <th:block th:replace="~{fragments/css :: mototrack}"></th:block>
    <title>MotoTrack</title>
</head>

<body>
<div class="wrap">

    <div th:replace="~{fragments/navbar :: navbar}"></div>

    <!-- Redireciona usuários autenticados para /home/ui -->
    <script th:inline="javascript" sec:authorize="hasAnyRole('USER','ADMIN')">
        /*<![CDATA[*/
        (function () {
            var target = /*[[@{/home/ui}]]*/ '/home/ui';
            if (window.location.pathname !== target) {
                var qs = window.location.search || '';
                var hash = window.location.hash || '';
                window.location.replace(target + qs + hash);
            }
        })();
        /*]]>*/
    </script>

    <main class="mt-20" aria-label="Módulos principais">
        <div class="page-wrap">
            <div th:replace="~{fragments/flash :: banners}"></div>

            <!-- Grade de módulos -->
            <section class="grid-modulos" aria-label="Atalhos do sistema">
                <!-- Agendamentos -->
                <article class="card" sec:authorize="hasAnyRole('USER','ADMIN')" aria-labelledby="ag-title">
                    <h3 id="ag-title">📅 Agendamentos</h3>
                    <p class="muted">Gerencie reservas e acompanhe o fluxo diário.</p>
                    <div class="row">
                        <a class="btn primary" th:href="@{/agendamentos/ui}">Acessar</a>
                    </div>
                </article>

                <!-- Usuários -->
                <article class="card" sec:authorize="hasRole('ADMIN')" aria-labelledby="us-title">
                    <h3 id="us-title">👤 Usuários</h3>
                    <p class="muted">Cadastro e gestão de usuários do sistema.</p>
                    <div class="row">
                        <a class="btn primary" th:href="@{/usuarios/ui}">Acessar</a>
                    </div>
                </article>

                <!-- Motos -->
                <article class="card" sec:authorize="hasAnyRole('USER','ADMIN')" aria-labelledby="mo-title">
                    <h3 id="mo-title">🏍️ Motos</h3>
                    <p class="muted">Consulta e manutenção do cadastro de motocicletas.</p>
                    <div class="row">
                        <a class="btn primary" th:href="@{/motos/ui}">Acessar</a>
                    </div>
                </article>

                <!-- Filiais -->
                <article class="card" sec:authorize="hasAnyRole('USER','ADMIN')" aria-labelledby="fi-title">
                    <h3 id="fi-title">🏢 Filiais</h3>
                    <p class="muted">Unidades operacionais da rede.</p>
                    <div class="row">
                        <a class="btn primary" th:href="@{/filiais/ui}">Acessar</a>
                    </div>
                </article>

                <!-- Eventos -->
                <article class="card" sec:authorize="hasAnyRole('USER','ADMIN')" aria-labelledby="ev-title">
                    <h3 id="ev-title">🗓️ Eventos</h3>
                    <p class="muted">Histórico de movimentações e registros.</p>
                    <div class="row">
                        <a class="btn primary" th:href="@{/eventos/ui}">Acessar</a>
                    </div>
                </article>

                <noscript>
                    <p class="muted">Dica: acesse diretamente <a th:href="@{/agendamentos/ui}">/agendamentos/ui</a>.</p>
                </noscript>
            </section>
        </div>
    </main>

    <div th:replace="~{fragments/footer :: footer}"></div>
</div>

</body>
</html>
