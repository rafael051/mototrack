<!-- templates/fragments/flash.html -->
<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<body>
<div th:fragment="banners">
    <!-- Sucesso -->
    <div class="flash ok"
         th:if="${msgSucesso}"
         th:text="${msgSucesso}"
         role="status" aria-live="polite"></div>

    <!-- Info -->
    <div class="flash info"
         th:if="${msgInfo}"
         th:text="${msgInfo}"
         role="status" aria-live="polite"></div>

    <!-- Erro simples -->
    <div class="flash error"
         th:if="${msgErro} and ${#lists.isEmpty(fieldErrors)}"
         th:text="${msgErro}"
         role="alert" aria-live="assertive"></div>

    <!-- Erros de validação (lista) -->
    <div class="flash error"
         th:if="${not #lists.isEmpty(fieldErrors)}"
         role="alert" aria-live="assertive">
        <strong th:text="${msgErro != null ? msgErro : 'Erro de validação'}"></strong>
        <ul class="list-errors">
            <li th:each="e : ${fieldErrors}" th:text="${e}"></li>
        </ul>
    </div>

    <!-- Auto-dismiss + botão fechar -->
    <script th:inline="javascript">
        (function () {
            var container = document.currentScript && document.currentScript.parentElement;
            if (!container) return;

            container.querySelectorAll('.flash').forEach(function (el) {
                var btn = document.createElement('button');
                btn.type = 'button';
                btn.className = 'flash-close';
                btn.setAttribute('aria-label','Fechar alerta');
                btn.textContent = '×';
                btn.addEventListener('click', function () { el.remove(); });
                el.prepend(btn);
            });

            setTimeout(function () {
                container.querySelectorAll('.flash').forEach(function (el) { el.remove(); });
            }, 4000);
        })();
    </script>
    <noscript><!-- Sem JS, banners permanecem visíveis até o próximo request --></noscript>
</div>

</body>
</html>
